<app-navbar></app-navbar>
<div class="container border p-3 mt-3" [formGroup]="timesheetForm">
    <div class="row">
        <p>Live Time: {{ currentDateTime | date: 'medium' }}</p>
    </div>

    <div class="row">
        <table>
            <tr>
                <td>
                    <label for="timeslot">Timeslot</label>
                    <select id="timeslot" class="w-100 mh-3"
                        formControlName="timeslot">
                        <option value="10AM-11AM">10AM-11AM</option>
                        <option value="11AM-12AM">11AM-12AM</option>
                        <option value="12AM-1PM">12AM-1PM</option>
                    </select>
                </td>
                <td>
                    <label for="function">Functions</label>
                    <select class="w-100"  formControlName="function">
                        <option value>-- Select Function --</option>
                        <option *ngFor="let func of functions" [value]="func.fuN_NAME">{{
                            func.fuN_NAME }}</option>
                    </select>
                    <div class="text-danger"
                        *ngIf="timesheetForm.get('function')?.invalid && timesheetForm.get('function')?.touched">
                        Function is required
                    </div>
                </td>

                <td>
                    <label for>ClientCode - ProjectName</label>
                    <select class="w-100" formControlName="projectAndClient">
                        <option value>-- Select Function --</option>
                        <option *ngFor="let prod of projectClients" [value]="prod.client_code+'-'+prod.proj_name">{{
                            prod.client_code+'-'+prod.proj_name }}</option>
                    </select>
                    <div class="text-danger"
                        *ngIf="timesheetForm.get('projectAndClient')?.invalid && timesheetForm.get('projectAndClient')?.touched">
                        clientCode-productName is required
                    </div>
                </td>

                <td>
                    <label for>Modules</label>
                    <select class="w-100" formControlName="module">
                        <option value=""></option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for>Type</label>
                    <select class="w-100" formControlName="type">
                        <option value disabled>Select Type</option>
                        <option value="Full">Full</option>
                        <option value="Split">Split</option>
                    </select>
                </td>
                <td>
                    <label for>Time</label>
                    <select class="w-100" formControlName="minute">
                        <option value disabled>Select Minute</option>
                        <option *ngFor="let min of minutes" [value]="min">{{ min
                            }}</option>
                    </select>
                </td>
                <td>
                    <label for>Description</label>
                    <textarea name id></textarea>
                </td>
                <td>
                    <button
                        class="btn btn-success"
                        type="submit"
                        (click)="onSubmit()"
                        [disabled]="timesheetForm.invalid">
                        Add Task
                    </button>
                </td>
            </tr>
        </table>
    </div>

    <div class="row">
        <table class="table table-bordered mt-4">
            <thead>
                <tr>
                    <th>Timeslot</th>
                    <th>Function</th>
                    <th>Project & Client</th>
                    <th>Module</th>
                    <th>Minute</th>
                </tr>
            </thead>
            <tbody>
                <ng-container *ngFor="let group of groupedTimesheet">
                    <tr *ngFor="let entry of group.entries; let i = index">
                        <td *ngIf="i === 0"
                            [attr.rowspan]="group.entries.length">{{
                            group.timeslot }}</td>
                        <td>{{ entry.function }}</td>
                        <td>{{ entry.projectAndClient }}</td>
                        <td>{{ entry.module }}</td>
                        <td>{{ entry.minute }}</td>
                    </tr>
                </ng-container>
            </tbody>
        </table>
    </div>
</div>
